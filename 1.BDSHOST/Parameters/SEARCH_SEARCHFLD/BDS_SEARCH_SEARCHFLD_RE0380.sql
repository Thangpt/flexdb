--
--
/
DELETE SEARCH WHERE SEARCHCODE = 'RE0380';
INSERT INTO SEARCH (SEARCHCODE,SEARCHTITLE,EN_SEARCHTITLE,SEARCHCMDSQL,OBJNAME,FRMNAME,ORDERBYCMDSQL,TLTXCD,CNTRECORD,ROWPERPAGE,AUTOSEARCH,INTERVAL,AUTHCODE,ROWLIMIT,CMDTYPE)
VALUES ('RE0380','Quản lý khách hàng của môi giới','General view of allocated to account','SELECT CF.CUSTODYCD, AF.ACCTNO, CF.FULLNAME CUSTNAME, AF.OPNDATE, CF.IDCODE, CF.IDDATE
    , NVL(RE.RM_NAME,''Chua co'') RMNAME, NVL(RE.DSF_NAME,''Chua co'') DSFNAME, NVL(RE.RM_NAME,RE.DSF_NAME) REACCTNO
    , TO_DATE(SYSDATE,''DD/MM/RRRR'') FRDATE, TO_DATE(SYSDATE,''DD/MM/RRRR'') TODATE
    , NVL(RE.RM_NAME,RE.DSF_NAME) RECUSTNAME, '' '' REROLE, '' '' RECUSTID, '' '' REACTYPE
FROM AFMAST AF, CFMAST CF
    ,(SELECT RE.*, CFRM.FULLNAME RM_NAME, CFDSF.FULLNAME DSF_NAME FROM
        (SELECT  RA.AFACCTNO
            , MAX(CASE WHEN RT.REROLE IN (''BM'',''RM'') THEN RA.REACCTNO ELSE NULL END) RM_REACCTNO
            , MAX(CASE WHEN RT.REROLE IN (''RD'') THEN RA.REACCTNO ELSE NULL END) DSF_REACCTNO
        FROM  REAFLNK RA, RECFDEF RD, RECFLNK RC, RETYPE RT
        WHERE RC.AUTOID = RD.REFRECFLNKID AND RA.REACCTNO = RC.CUSTID||RD.REACTYPE AND RT.ACTYPE = RD.REACTYPE
        AND RA.STATUS = ''A'' AND RC.STATUS = ''A''
        GROUP BY RA.AFACCTNO) RE, CFMAST CFRM, CFMAST CFDSF
     WHERE SUBSTR(NVL(RM_REACCTNO,''XXXXXXXXXXXXXX''),1,10) = CFRM.CUSTID (+) AND SUBSTR(NVL(DSF_REACCTNO,''XXXXXXXXXXXXXX''),1,10) = CFDSF.CUSTID (+)
    ) RE
WHERE AF.ACCTNO = RE.AFACCTNO(+)
AND AF.STATUS IN (''A'',''P'') AND AF.CUSTID = CF.CUSTID AND ( RM_REACCTNO IS NULL OR DSF_REACCTNO IS NULL)','RETYPE',null,null,'0380',null,50,'N',30,'NYNNYYYNNN','Y','T');
COMMIT;
/
--
--
/
DELETE SEARCHFLD WHERE SEARCHCODE = 'RE0380';
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (12,'TODATE','Ngày HH','C','RE0380',0,null,'=,LIKE',null,'N','N','N',100,null,'Effective date','N','06',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (11,'FRDATE','Ngày HL','C','RE0380',0,null,'=,LIKE',null,'N','N','N',100,null,'Effective date','N','05',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (10,'REACTYPE','Mã loại hình','C','RE0380',0,null,'=,LIKE',null,'N','N','N',20,null,'Remiser type','N','07',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (9,'RECUSTID','Số TK môi giới','C','RE0380',0,null,'=,LIKE',null,'N','N','N',20,null,'Remiser afacctno','N','02',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (8,'REROLE','Vai trò','C','RE0380',0,null,'=,LIKE',null,'N','N','N',150,null,'Remiser name','N','09',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (7,'RECUSTNAME','Tên môi giới','C','RE0380',0,null,'=,LIKE',null,'N','N','N',150,null,'Remiser name','N','91',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (6,'REACCTNO','Môi giới','C','RE0380',0,null,'=,LIKE',null,'N','N','N',14,null,'REMISER ACCTNO','N','08',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (5,'DSFNAME','DSF hiện tại','C','RE0380',200,null,'=,LIKE',null,'Y','Y','N',150,null,'Remiser name','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (4,'RMNAME','Môi giới hiện tại','C','RE0380',200,null,'=,LIKE',null,'Y','Y','N',150,null,'Remiser name','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (3,'CUSTNAME','Tên khách hàng','C','RE0380',100,null,'LIKE,=',null,'Y','Y','N',300,null,'Customer name','Y','90',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (2,'ACCTNO','Số tiểu khoản','C','RE0380',50,'9999.999999','LIKE,=','_','Y','Y','Y',100,null,'Sub account','N','03',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (1,'CUSTODYCD','Số TK lưu ký','C','RE0380',50,'cccc.cccccc','LIKE,=','_','Y','Y','N',100,null,'Custody code','N','88',null,'N',null,null,null,'N');
COMMIT;
/
