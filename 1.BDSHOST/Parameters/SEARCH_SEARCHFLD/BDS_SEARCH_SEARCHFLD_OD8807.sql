--
--
/
DELETE SEARCH WHERE SEARCHCODE = 'OD8807';
INSERT INTO SEARCH (SEARCHCODE,SEARCHTITLE,EN_SEARCHTITLE,SEARCHCMDSQL,OBJNAME,FRMNAME,ORDERBYCMDSQL,TLTXCD,CNTRECORD,ROWPERPAGE,AUTOSEARCH,INTERVAL,AUTHCODE,ROWLIMIT,CMDTYPE)
VALUES ('OD8807','Tra cứu giải tỏa lệnh bán (8807)','View clearing sell order(wait for 8807)','SELECT MST.ORDERID, MST.ACTYPE, MST.CODEID, CCY.SYMBOL, CCY.PARVALUE,CCY.TRADEPLACE, MST.AFACCTNO, MST.SEACCTNO, MST.CIACCTNO,
CF.FULLNAME CUSTNAME, CF.CUSTODYCD, CF.ADDRESS, CF.IDCODE LICENSE, CI.RAMT, CI.AAMT, CI.RAMT-CI.AAMT AVLAMT, CI.BALANCE, CI.ODAMT, CI.BAMT, SE.SECURED,
MST.TXDATE, MST.TXNUM, MST.EXPDATE, MST.BRATIO, MST.BRATIO/100 SRATIO, MST.CLEARDAY, MST.VOUCHER, MST.EXECAMT-MST.EXAMT AVLEXAMT,
MST.QUOTEPRICE, MST.STOPPRICE, MST.LIMITPRICE, MST.EXPRICE, MST.EXQTTY, MST.EXECAMT, MST.EXAMT, MST.FEEAMT, MST.FEEACR, MST.RLSSECURED, MST.MATCHAMT, MST.SECUREDAMT,
(CASE WHEN MST.ORDERQTTY-MST.EXECQTTY-MST.ADJUSTQTTY-MST.CANCELQTTY>0 THEN MST.ORDERQTTY-MST.EXECQTTY-MST.ADJUSTQTTY-MST.CANCELQTTY ELSE 0 END) AVLCANCELQTTY,
(CASE WHEN EXECTYPE=''NB'' OR EXECTYPE=''BC'' THEN 1 ELSE 0 END)*(CASE WHEN MST.SECUREDAMT-MST.MATCHAMT-MST.RLSSECURED>0 THEN MST.SECUREDAMT-MST.MATCHAMT-MST.RLSSECURED ELSE 0 END) AVLCANCELAMT,
(CASE WHEN EXECTYPE=''NB'' OR EXECTYPE=''BC'' THEN 1 ELSE 0 END)*(CASE WHEN MST.SECUREDAMT-(MST.EXPRICE*MST.REMAINQTTY+MST.MATCHAMT)-MST.RLSSECURED>0 THEN MST.SECUREDAMT-(MST.EXPRICE*MST.REMAINQTTY+MST.MATCHAMT)-MST.RLSSECURED ELSE 0 END) AVLSECUREDAMT,
(CASE WHEN EXECTYPE=''NB'' OR EXECTYPE=''BC'' THEN 1 ELSE 1 END)*(CASE WHEN MST.SECUREDAMT-(MST.EXPRICE*MST.REMAINQTTY+MST.MATCHAMT+MST.FEEACR)-MST.RLSSECURED<0 THEN (MST.EXPRICE*MST.REMAINQTTY+MST.MATCHAMT+MST.FEEACR)+ MST.RLSSECURED-MST.SECUREDAMT ELSE 0 END) AVLDEPOSITAMT,
(CASE WHEN MST.ORDERQTTY-MST.REMAINQTTY-MST.EXECQTTY-MST.ADJUSTQTTY-MST.CANCELQTTY>0 THEN MST.ORDERQTTY-MST.REMAINQTTY-MST.EXECQTTY-MST.ADJUSTQTTY-MST.CANCELQTTY ELSE 0 END) QTTY,
(CASE WHEN EXECTYPE=''NB'' OR EXECTYPE=''BC'' THEN ''B'' ELSE ''S'' END) BORS,
(CASE WHEN NORK=''N'' THEN ''N'' ELSE ''A'' END) AORN,
(CASE WHEN MATCHTYPE=''N'' THEN ''N'' ELSE ''P'' END) NORP,  (CASE WHEN MST.REMAINQTTY < MST.ORDERQTTY THEN ''4'' WHEN MST.REMAINQTTY = MST.ORDERQTTY THEN ''5'' ELSE MST.ORSTATUS END) EXORSTATUS,
MST.ORDERQTTY, MST.REMAINQTTY, MST.EXECQTTY, MST.STANDQTTY, MST.CANCELQTTY, MST.ADJUSTQTTY, MST.REJECTQTTY,
MST.TIMETYPE, MST.EXECTYPE, MST.NORK, MST.MATCHTYPE, MST.VIA, MST.CLEARCD, A0.CDCONTENT  ORSTATUS,A1.CDCONTENT PRICETYPE, MST.REJECTCD,
(CASE WHEN MST.EXECTYPE=''MS'' THEN 1 ELSE 0 END) ISMORTAGE
FROM ODMAST MST, AFMAST AF, CFMAST CF, SBSECURITIES CCY, CIMAST CI,SEMAST SE,ALLCODE A0,ALLCODE A1
WHERE MST.AFACCTNO = AF.ACCTNO And MST.CIACCTNO = CI.ACCTNO AND MST.SEACCTNO = SE.ACCTNO
AND MST.REMAINQTTY>0 AND MST.DELTD<> ''Y'' AND MST.GRPORDER <> ''Y''
AND AF.CUSTID = CF.CUSTID AND MST.CODEID = CCY.CODEID
AND (CASE WHEN EXECTYPE=''NB'' OR EXECTYPE=''BC'' THEN ''B'' ELSE ''S'' END)=''S''
AND EXECTYPE in (''NS'',''MS'')
AND MST.ORSTATUS IN (''1'', ''2'', ''4'')  AND A0.CDTYPE=''OD'' AND A0.CDNAME=''ORSTATUS'' AND A0.CDVAL=MST.ORSTATUS AND A1.CDTYPE=''OD'' AND A1.CDNAME=''PRICETYPE'' AND A1.CDVAL=MST.PRICETYPE
AND MST.ORDERID NOT IN (SELECT ODMAST.REFORDERID FROM ODMAST,OOD WHERE EXECTYPE IN (''AS'',''CS'') AND ODMAST.ORDERID=OOD.ORGORDERID AND OOD.OODSTATUS  IN (''N'',''B'') )','ODMAST',null,null,'8807',null,50,'N',30,'NYNNYYYNNN','Y','T');
COMMIT;
/
--
--
/
DELETE SEARCHFLD WHERE SEARCHCODE = 'OD8807';
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (14,'TIMETYPE','Loại thời gian','C','OD8807',100,null,'LIKE,=','_','Y','Y','N',100,null,'Time type','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (13,'ORSTATUS','Trạng thái lệnh','C','OD8807',100,null,'LIKE,=',null,'Y','Y','N',100,'SELECT CDVAL VALUE, CDCONTENT DISPLAY FROM ALLCODE WHERE CDTYPE = ''OD'' AND CDNAME = ''ORSTATUS'' ORDER BY LSTODR','Status','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (13,'EXORSTATUS','Trạng thái lệnh','C','OD8807',100,null,'LIKE,=',null,'N','Y','N',100,'SELECT CDVAL VALUE, CDCONTENT DISPLAY FROM ALLCODE WHERE CDTYPE = ''OD'' AND CDNAME = ''ORSTATUS'' ORDER BY LSTODR','Status','N','15',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (12,'EXPRICE','Giá đặt lệnh','N','OD8807',100,null,'<,<=,=,>=,>,<>','#,##0','Y','Y','N',100,null,'EX Price','N','13',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (11,'PARVALUE','Mệnh giá','N','OD8807',100,null,'<,<=,=,>=,>,<>','#,##0','Y','Y','N',100,null,'Parvalue','N','12',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (10,'AVLCANCELAMT','Giá trị ký quỹ được giải tỏa','N','OD8807',100,null,'<,<=,=,>=,>,<>',null,'Y','Y','N',100,null,'Secured release amount','N','11',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (9,'AVLCANCELQTTY','Khối lượng giải tỏa','N','OD8807',100,null,'<,<=,=,>=,>,<>','#,##0','Y','Y','N',100,null,'Clearing quantity','N','10',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (8,'AFACCTNO','Số Tiểu khoản','C','OD8807',100,null,'LIKE,=','_','Y','Y','N',100,null,'Contract number','N','07',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (7,'SEACCTNO','Số tài khoản SE','C','OD8807',100,null,'LIKE,=','_','N','Y','N',100,null,'SE account number','N','06',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (7,'ISMORTAGE','Bán cầm cố','N','OD8807',100,null,'<,<=,=,>=,>,<>',null,'N','N','N',100,null,'Is mortage sell','N','60',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (6,'CIACCTNO','Số tài khoản CI','C','OD8807',100,'9999999999','LIKE,=','_','N','Y','N',100,null,'CI account number','N','05',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (3,'TRADEPLACE','Sàn giao dịch','C','OD8807',100,null,'=',null,'Y','Y','N',100,'SELECT CDVAL VALUE , CDCONTENT DISPLAY FROM ALLCODE WHERE CDTYPE=''SA'' AND CDNAME=''TRADEPLACE'' ORDER BY LSTODR ','Trade place','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (2,'CUSTODYCD','Số tài khoản lưu ký','C','OD8807',100,null,'LIKE,=',null,'Y','Y','N',100,null,'Custody code','N','82',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (1,'SYMBOL','Chứng khoán','C','OD8807',100,null,'LIKE,=',null,'Y','Y','N',100,null,'Symbol','N','81',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (0,'ORDERID','Số hiệu lệnh gốc','C','OD8807',100,'9999.999999.999999','LIKE,=','_','Y','Y','Y',100,null,'Original order ID','N','03',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (0,'CODEID','Chứng khoán','C','OD8807',100,null,'LIKE,=',null,'N','N','N',100,null,'Symbol','N','80',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (-1,'PRICETYPE','Loại lệnh','C','OD8807',100,null,'LIKE,=',null,'Y','Y','N',100,'SELECT CDVAL VALUE, CDCONTENT DISPLAY FROM ALLCODE WHERE CDTYPE = ''OD'' AND CDNAME = ''PRICETYPE''  ORDER BY SUBSTR(VALUE,1,2),SUBSTR(VALUE,3,1) DESC ','Price Type','N',null,null,'N',null,null,null,'N');
COMMIT;
/
