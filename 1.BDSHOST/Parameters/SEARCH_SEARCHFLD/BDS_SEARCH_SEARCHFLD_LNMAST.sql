--
--
/
DELETE SEARCH WHERE SEARCHCODE = 'LNMAST';
INSERT INTO SEARCH (SEARCHCODE,SEARCHTITLE,EN_SEARCHTITLE,SEARCHCMDSQL,OBJNAME,FRMNAME,ORDERBYCMDSQL,TLTXCD,CNTRECORD,ROWPERPAGE,AUTOSEARCH,INTERVAL,AUTHCODE,ROWLIMIT,CMDTYPE)
VALUES ('LNMAST','Tài khoản vay','Customer loan account management','SELECT MST.PRINNML+MST.PRINOVD+MST.INTNMLACR+MST.INTOVDACR+MST.INTNMLOVD+MST.INTDUE-
MST.INTPREPAID+MST.OPRINNML+MST.OPRINOVD+MST.OINTNMLACR+
MST.OINTOVDACR+MST.OINTNMLOVD+MST.OINTDUE-MST.OINTPREPAID+
MST.FEE+MST.FEEDUE+MST.FEEOVD+mst.feeintnmlacr+mst.feeintdue+mst.feeintovdacr+mst.feeintnmlovd ODAMT,
 MST.ACTYPE, MST.TRFACCTNO,
TYP.TYPENAME, CF.CUSTID, CF.FULLNAME, MST.ACCTNO, SBY.SHORTCD,
MST.CCYCD, A0.CDCONTENT DESC_STATUS, MST.NOTES, CF.CUSTODYCD,
(CASE WHEN MST.FTYPE =''AF'' THEN 1 ELSE 0 END) FINANCETYPE,
TYP.ACTYPE LNTYPE,MST.OPNDATE,(MST.OPNDATE+ MST.PRINFRQ) DUEDATE,(MST.OPNDATE+ MST.PRINPERIOD) OVDUEDATE,
MST.RATE1,MST.RATE2,MST.RATE3,MST.CFRATE1,MST.CFRATE2,MST.CFRATE3,
MST.PRINNML,MST.PRINOVD,MST.PRINPAID,nvl(schddue.PRINDUE,0) prindue,
MST.INTNMLACR,MST.INTDUE,MST.INTNMLOVD,MST.INTOVDACR,MST.INTPAID,
MST.FEEINTNMLACR,MST.FEEINTDUE,MST.FEEINTNMLOVD,MST.FEEINTOVDACR,MST.FEEINTPAID,MST.AUTOAPPLY,MST.PREPAID,
MST.ADVPAY,MST.ADVPAYFEE,MST.FTYPE,MST.MINTERM
FROM LNTYPE TYP, LNMAST MST, SBCURRENCY SBY, CFMAST CF, CIMAST CI, ALLCODE A0, AFMAST AF,
(select schd.acctno,sum ((CASE WHEN SCHD.OVERDUEDATE = TO_DATE(''<$BUSDATE>'',''DD/MM/YYYY'') THEN SCHD.NML ELSE 0 END) ) PRINDUE from lnschd  schd where reftype=''P''  group by schd.acctno) schddue
WHERE MST.CCYCD=SBY.CCYCD AND TYP.ACTYPE=MST.ACTYPE AND A0.CDTYPE=''LN''
AND A0.CDNAME=''STATUS'' AND A0.CDVAL=MST.STATUS
AND CI.ACCTNO=MST.TRFACCTNO AND CI.CUSTID=CF.CUSTID
AND CI.Afacctno=af.acctno
and schddue.acctno(+)=mst.acctno
AND AF.CAREBY IN (SELECT TLGRP.GRPID FROM TLGRPUSERS TLGRP WHERE TLID = ''<$TELLERID>'')','LNMAST','frmLNMAST',null,null,null,50,'N',0,null,'Y','T');
COMMIT;
/
--
--
/
DELETE SEARCHFLD WHERE SEARCHCODE = 'LNMAST';
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (12,'NOTES','Diễn giải','C','LNMAST',100,null,'LIKE,=',null,'Y','Y','N',200,null,'Description','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (11,'DESC_STATUS','Trạng thái','C','LNMAST',100,null,'=',null,'Y','N','N',200,'SELECT CDVAL VALUE, CDCONTENT DISPLAY FROM ALLCODE WHERE CDTYPE = ''LN'' AND CDNAME = ''STATUS'' ORDER BY LSTODR','Status','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (7,'ODAMT','Tổng dư nợ','N','LNMAST',250,null,'<,<=,=,>=,>,<>','#,##0.###0','Y','N','N',100,null,'Loan amount','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (6,'SHORTCD','Loại tiền','C','LNMAST',100,'cc','LIKE,=','_','Y','Y','N',100,null,'Currency','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (5,'FULLNAME','Tên khách hàng','C','LNMAST',100,null,'LIKE,=',null,'Y','Y','N',150,null,'Customer name','Y',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (4,'CUSTID','Mã khách hàng','C','LNMAST',100,null,'LIKE,=',null,'Y','Y','N',150,null,'CustomerID','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (3,'TRFACCTNO','Số tài khoản CI','C','LNMAST',100,null,'LIKE,=','ccccdcccccc','Y','Y','N',150,null,'CI account number','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (2,'TYPENAME','Tên loại hình','C','LNMAST',100,null,'LIKE,=',null,'Y','Y','N',150,null,'Product name','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (1,'ACTYPE','Mã loại hình','C','LNMAST',100,'9999','LIKE,=','_','Y','N','N',100,null,'Product type','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (0,'ACCTNO','Số tài khoản vay','C','LNMAST',100,null,'LIKE,=','ccccdccccccdcccccc','Y','Y','Y',150,null,'Loan account number','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (-1,'CUSTODYCD','Số lưu ký','C','LNMAST',100,null,'=, LIKE',null,'Y','Y','N',80,null,'Custody code','N',null,null,'N',null,null,null,'N');
COMMIT;
/
