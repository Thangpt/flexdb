--
--
/
DELETE SEARCH WHERE SEARCHCODE = 'OD8833';
INSERT INTO SEARCH (SEARCHCODE,SEARCHTITLE,EN_SEARCHTITLE,SEARCHCMDSQL,OBJNAME,FRMNAME,ORDERBYCMDSQL,TLTXCD,CNTRECORD,ROWPERPAGE,AUTOSEARCH,INTERVAL,AUTHCODE,ROWLIMIT,CMDTYPE)
VALUES ('OD8833','Tra c?u di?u ch?nh mã d?nh danh cho l?nh giao d?ch TPCP','Tra c?u di?u ch?nh mã d?nh danh cho l?nh giao d?ch TPCP','SELECT od.orderid, od.txdate, st.cleardate, iod.confirm_no confirmnumber,
    cf.custodycd, od.afacctno, cf.fullname, sb.symbol,OD.EXECQTTY orderqtty,iod.MATCHPRICE quoteprice, AL.CDCONTENT exectype, SB.CODEID
FROM (SELECT * FROM  VW_IOD_ALL IOD WHERE txdate >=getcurrdate-20) iod,
     (SELECT /*DISTINCT(ST.STATUS) STATUS,*/ ST.ORGORDERID, MAX(ST.CLEARDATE) CLEARDATE FROM VW_STSCHD_ALL ST WHERE /*ST.STATUS <> ''C''*/ txdate >=getcurrdate-20
             GROUP BY /*STATUS,*/ST.ORGORDERID) ST,
     cfmast cf, afmast af, (SELECT * FROM VW_ODMAST_ALL WHERE txdate >= getcurrdate-20) od, sbsecurities sb,ALLCODE AL
WHERE IOD.ORGORDERID = ST.ORGORDERID
AND IOD.ORGORDERID = OD.ORDERID
AND od.errod = ''N'' AND od.matchtype = ''P''
AND od.exectype IN (''NS'',''MS'')
AND od.codeid = sb.codeid
AND sb.bondtype IN (''001'',''002'',''003'')
AND cf.custid = af.custid
AND af.acctno = od.afacctno
AND SB.SECTYPE IN (''006'')
AND ST.CLEARDATE >= getcurrdate
AND AL.CDNAME = ''EXECTYPE''
AND AL.CDTYPE = ''OD''
AND AL.CDVAL = OD.EXECTYPE
UNION ALL
SELECT od.orderid, od.txdate, st.cleardate, iod.confirm_no confirmnumber,
    cf.custodycd, od.afacctno, cf.fullname, sb.symbol,OD.EXECQTTY orderqtty,iod.MATCHPRICE quoteprice, AL.CDCONTENT exectype, SB.CODEID
FROM (SELECT * FROM  VW_IOD_ALL IOD WHERE txdate >=getcurrdate-20) iod,
     (SELECT /*DISTINCT(ST.STATUS) STATUS,*/ ST.ORGORDERID, MAX(ST.CLEARDATE) CLEARDATE FROM STSCHD ST WHERE ST.STATUS <> ''C''
             GROUP BY /*STATUS,*/ST.ORGORDERID) ST,
     cfmast cf, afmast af, (SELECT * FROM VW_ODMAST_ALL WHERE txdate >= getcurrdate-20) od, sbsecurities sb,ALLCODE AL
WHERE IOD.ORGORDERID = ST.ORGORDERID
AND IOD.ORGORDERID = OD.ORDERID
AND od.errod = ''N'' AND od.matchtype = ''P''
AND od.exectype IN (''NB'')
AND od.codeid = sb.codeid
AND sb.bondtype IN (''001'',''002'',''003'')
AND cf.custid = af.custid
AND af.acctno = od.afacctno
AND SB.SECTYPE IN (''006'')
AND ST.CLEARDATE >= getcurrdate
AND AL.CDNAME = ''EXECTYPE''
AND AL.CDTYPE = ''OD''
AND AL.CDVAL = OD.EXECTYPE','ODMAST',null,null,'8833',null,50,'N',30,'NYNNYYYNNN','Y','T');
COMMIT;
/
--
--
/
DELETE SEARCHFLD WHERE SEARCHCODE = 'OD8833';
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (11,'CODEID','Mã ch?ng khoán','C','OD8833',110,null,'LIKE,=','_','N','N','N',80,null,'CODEID','N','01',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (10,'QUOTEPRICE','Giá','N','OD8833',100,null,'<,<=,=,>=,>,<>','#,##0','Y','Y','N',80,null,'Price','N','16',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (9,'ORDERQTTY','S? lu?ng','N','OD8833',100,null,'<,<=,=,>=,>,<>','#,##0','Y','Y','N',80,null,'Quantity','N','09',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (8,'SYMBOL','Mã ch?ng khoán','C','OD8833',110,null,'LIKE,=','_','Y','Y','N',80,null,'Symbol','N','07',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (7,'EXECTYPE','Lo?i l?nh','C','OD8833',110,null,'LIKE,=','_','Y','Y','N',80,null,'Exc type','N','22',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (6,'FULLNAME','H? tên','C','OD8833',250,null,'LIKE,=',null,'Y','Y','N',150,null,'Full name','N','90',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (5,'AFACCTNO','S? ti?u kho?n','C','OD8833',100,null,'LIKE,=','_','Y','Y','N',100,null,'CONTRAC NO','N','04',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (4,'CUSTODYCD','S? TK luu ký','C','OD8833',10,'ccc.c.cccccc','LIKE,=','_','Y','Y','N',100,null,'Custody code','N','88',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (3,'CONFIRMNUMBER','Mã d?nh danh','C','OD8833',100,null,'LIKE,=','_','Y','Y','N',80,null,'Confirm no','N','19',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (2,'CLEARDATE','Ngày thanh toán','D','OD8833',100,null,'<,<=,=,>=,>,<>',null,'Y','Y','N',80,null,'Clear Date','N','18',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (1,'TXDATE','Ngày giao d?ch','D','OD8833',100,null,'<,<=,=,>=,>,<>',null,'Y','Y','N',80,null,'Tx.Date','N','17',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (0,'ORDERID','S? hi?u l?nh','C','OD8833',150,null,'LIKE,=',null,'Y','Y','Y',110,null,'Order ID','N','03',null,'N',null,null,null,'N');
COMMIT;
/
