--
--
/
DELETE SEARCH WHERE SEARCHCODE = 'CA1001';
INSERT INTO SEARCH (SEARCHCODE,SEARCHTITLE,EN_SEARCHTITLE,SEARCHCMDSQL,OBJNAME,FRMNAME,ORDERBYCMDSQL,TLTXCD,CNTRECORD,ROWPERPAGE,AUTOSEARCH,INTERVAL,AUTHCODE,ROWLIMIT,CMDTYPE)
VALUES ('CA1001','Thông tin số dư tài khoản lưu ký chứng khóan (đối chiếu)','Coporate action detail','SELECT * FROM (
SELECT * FROM (
SELECT   CF.CUSTODYCD CUSTODYCD,
         CF.IDCODE, CF.IDDATE, MAX(CF.FULLNAME) FULLNAME,
         MAX(AF.ACTYPE) ACTYPE, SYM.SYMBOL, ''Giao dịch''  TYPE,
         SUM(SE.TRADE) TRADE
         FROM SEMAST  SE,SBSECURITIES SYM,
AFMAST AF, CFMAST CF
WHERE  SYM.SECTYPE <>''004''
     AND SYM.CODEID = SE.CODEID
     AND AF.ACCTNO = SE.AFACCTNO
     AND CF.CUSTID = AF.CUSTID
     AND  SE.TRADE  >0
     GROUP  BY CF.custodycd, CF.IDCODE, CF.IDDATE,  SYM.SYMBOL
     ORDER BY CF.custodycd , SYM.SYMBOL ) A
UNION ALL
SELECT * FROM (
SELECT   CF.CUSTODYCD CUSTODYCD,
         CF.IDCODE, CF.IDDATE, MAX(CF.FULLNAME) FULLNAME,
         MAX(AF.ACTYPE) ACTYPE, SYM.SYMBOL, ''Chờ thanh toán''  TYPE,
         SUM(SE.NETTING) TRADE
         FROM SEMAST  SE,SBSECURITIES SYM,
AFMAST AF, CFMAST CF
WHERE  SYM.SECTYPE <>''004''
     AND SYM.CODEID = SE.CODEID
     AND AF.ACCTNO = SE.AFACCTNO
     AND CF.CUSTID = AF.CUSTID
     AND  SE.NETTING  >0
     GROUP  BY CF.custodycd, CF.IDCODE, CF.IDDATE,  SYM.SYMBOL
     ORDER BY CF.custodycd , SYM.SYMBOL ) B
UNION ALL
SELECT * FROM (
SELECT   CF.CUSTODYCD CUSTODYCD,
         CF.IDCODE, CF.IDDATE, MAX(CF.FULLNAME) FULLNAME,
         MAX(AF.ACTYPE) ACTYPE, SYM.SYMBOL, ''Chờ GD''  TYPE,
         SUM(SE.PENDING) TRADE
         FROM SEMAST  SE,SBSECURITIES SYM,
AFMAST AF, CFMAST CF
WHERE  SYM.SECTYPE <>''004''
     AND SYM.CODEID = SE.CODEID
     AND AF.ACCTNO = SE.AFACCTNO
     AND CF.CUSTID = AF.CUSTID
     AND  SE.PENDING  >0
     GROUP  BY CF.custodycd, CF.IDCODE, CF.IDDATE,  SYM.SYMBOL
     ORDER BY CF.custodycd , SYM.SYMBOL ) C
UNION ALL
SELECT * FROM (
SELECT   CF.CUSTODYCD CUSTODYCD,
         CF.IDCODE, CF.IDDATE, MAX(CF.FULLNAME) FULLNAME,
         MAX(AF.ACTYPE) ACTYPE, SYM.SYMBOL, ''Hạn chế CN''  TYPE,
         SUM(SE.B_QTTY) TRADE
         FROM  (SELECT SE.*, NVL(DTL.QTTY,0) B_QTTY FROM
                (SELECT * FROM SEMAST) SE
                LEFT JOIN
                (SELECT   ACCTNO,SUM(QTTY) QTTY FROM SEMASTDTL
                WHERE DELTD=''N'' GROUP BY ACCTNO ) DTL ON SE.ACCTNO = DTL.ACCTNO ) SE ,SBSECURITIES SYM,
AFMAST AF, CFMAST CF
WHERE  SYM.SECTYPE <>''004''
     AND SYM.CODEID = SE.CODEID
     AND AF.ACCTNO = SE.AFACCTNO
     AND CF.CUSTID = AF.CUSTID
     AND  SE.B_QTTY  >0
     GROUP  BY CF.custodycd, CF.IDCODE, CF.IDDATE,  SYM.SYMBOL
     ORDER BY CF.custodycd , SYM.SYMBOL ) D

     ) WHERE 0=1  ','SEMAST','frmSEMAST',null,null,null,50,'N',30,'NYNNYYYNNY','Y','T');
COMMIT;
/
--
--
/
DELETE SEARCHFLD WHERE SEARCHCODE = 'CA1001';
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (7,'PENDING','SL chờ giao dịch','N','CA1001',100,null,'<,<=,=,>=,>','#,##0','Y','Y','N',100,null,'Pending','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (6,'NETTING','SL chờ thanh toán','N','CA1001',100,null,'<,<=,=,>=,>','#,##0','Y','Y','N',100,null,'Netting','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (5,'TRADE','SL giao dịch','N','CA1001',100,null,'<,<=,=,>=,>','#,##0','Y','Y','N',100,null,'Trade','N',null,null,'N',null,null,'12','N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (4,'TYPE','Phân loại','C','CA1001',100,null,'LIKE,=',null,'Y','Y','N',120,null,'type','N',null,null,'N',null,null,'11','Y');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (3,'SYMBOL','Chứng khoán','C','CA1001',100,null,'LIKE,=',null,'Y','Y','N',120,null,'Symbol','N',null,null,'N',null,null,'6','Y');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (2,'IDDATE','Ngày cấp','D','CA1001',100,null,'=,LIKE',null,'Y','Y','N',100,null,'Id date','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (1,'IDCODE','Số CMT','C','CA1001',100,null,'=',null,'Y','Y','N',100,null,'Id code','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (0,'FULLNAME','Tên đầy đủ','C','CA1001',250,null,'=',null,'Y','Y','N',250,null,'Full name','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (-1,'CUSTODYCD','Số lưu ký','C','CA1001',100,null,'=, LIKE',null,'Y','Y','N',120,null,'Custody code','N',null,null,'N',null,null,'10','Y');
COMMIT;
/
