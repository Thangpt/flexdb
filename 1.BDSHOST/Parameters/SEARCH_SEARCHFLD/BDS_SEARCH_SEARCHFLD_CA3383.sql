--
--
/
DELETE SEARCH WHERE SEARCHCODE = 'CA3383';
INSERT INTO SEARCH (SEARCHCODE,SEARCHTITLE,EN_SEARCHTITLE,SEARCHCMDSQL,OBJNAME,FRMNAME,ORDERBYCMDSQL,TLTXCD,CNTRECORD,ROWPERPAGE,AUTOSEARCH,INTERVAL,AUTHCODE,ROWLIMIT,CMDTYPE)
VALUES ('CA3383','Chuyển nhượng quyền mua ra ngoài công ty','Transfer','
SELECT MST.*, (CASE WHEN VW.ISSUERMEMBER=''Y'' THEN ''Thành viên quản trị của TCPH'' ELSE ''Không'' END ) ISSUERMEMBER, M.VARVALUE FROMCUSADD, (CASE WHEN VW.ISSUERMEMBER=''Y''THEN ''Y'' ELSE ''N'' END ) ISSUERMEMBERCD   FROM
(SELECT (CA.Pbalance-ca.inbalance) QTTY, (CA.Pbalance- ca.inbalance) PQTTY ,
SUBSTR(CAMAST.CAMASTID,1,4) || ''.''||
SUBSTR(CAMAST.CAMASTID,5,6) ||''.'' ||
SUBSTR(CAMAST.CAMASTID,11,6) CAMASTID,
       CA.AFACCTNO, CAMAST.optcodeid  CODEID,
SYM.SYMBOL,SYM.TRADEPLACE, A1.CDCONTENT
STATUS,CA.AFACCTNO || CAMAST.CODEID
SEACCTNO,SYM.PARVALUE PARVALUE,
       CAMAST.REPORTDATE REPORTDATE,
CAMAST.ACTIONDATE,CAMAST.EXPRICE, AFM.*, A2.CDCONTENT
CATYPE, CAMAST.TRFLIMIT,ISS.FULLNAME ISSNAME,
CAMAST.codeid codeid0,
CA.autoid, sb2.symbol tosymbol, iss2.fullname toissname,
sb2.codeid tocodeid, CAMAST.ISINCODE, CAMAST.VNCODE
FROM  SBSECURITIES SYM,issuers ISS , ALLCODE A1, CAMAST, CASCHD CA,
      (   Select af.ACCTNO, CF.CUSTODYCD, cf.fullname
CUSTNAME, A1.CDCONTENT COUNTRY, cf.address,
          --cf.idcode LICENSE,
          (case when cf.country = ''234'' then cf.idcode else cf.tradingcode end) LICENSE,
         (case when cf.country = ''234'' then cf.iddate else cf.tradingcodedt end) iddate,
          cf.idplace
        From cfmast cf, afmast af, ALLCODE A1
        Where af.custid = cf.custid
              and af.status  IN (''A'',''N'')
              AND CF.COUNTRY = A1.CDVAL
              AND A1.CDTYPE =''CF''
              AND A1.CDNAME = ''COUNTRY''
       ) AFM, ALLCODE A2, sbsecurities sb2, issuers iss2
WHERE CA.AFACCTNO=AFM.ACCTNO AND A1.CDTYPE = ''CA'' AND
A1.CDNAME = ''CASTATUS'' AND A1.CDVAL = CA.STATUS AND
CAMAST.CODEID = SYM.CODEID AND CAMAST.status in
(''V'',''S'',''M'')
      AND  CAMAST.catype=''014'' AND CA.camastid =
CAMAST.camastid AND CA.status in(''V'',''S'',''M'') AND
CA.DELTD <>''Y'' AND CA.PBALANCE - ca.inbalance > 0
      AND CAMAST.CATYPE = A2.CDVAL AND A2.CDTYPE = ''CA''
AND A2.CDNAME = ''CATYPE'' AND CAMAST.TRFLIMIT = ''Y''
AND ISS.ISSUERID = SYM.ISSUERID
and nvl(camast.tocodeid, camast.codeid) = sb2.codeid
and sb2.issuerid = iss2.issuerid
AND camast.frdatetransfer <= GETCURRDATE() AND camast.todatetransfer >=GETCURRDATE()
) MST, ( Select VWW.*, ''Y'' ISSUERMEMBER from VW_ISSUER_MEMBER VWW ) VW, (select VARVALUE from sysvar where VARNAME like ''%ISSUERMEMBER%'') M
WHERE  MST.CUSTODYCD = VW.CUSTODYCD  (+)
                AND MST.SYMBOL = VW.SYMBOL (+)','CAMAST',null,null,'3383',null,50,'N',30,'NYNNYYYNNN','Y','T');
COMMIT;
/
--
--
/
DELETE SEARCHFLD WHERE SEARCHCODE = 'CA3383';
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (48,'VNCODE','Mã thực hiện quyền trong nước','C','CA3383',100,null,'LIKE,=',null,'Y','Y','N',100,null,'VN CODE','N','11',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (47,'ISINCODE','Mã ISIN','C','CA3383',100,null,'LIKE,=',null,'Y','Y','N',100,null,'ISIN CODE','N','10',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (46,'TOCODEID','Mã CK nhận','C','CA3383',100,null,'LIKE,=',null,'Y','N','N',100,null,'ISSNAME','N','62',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (45,'TOISSNAME','Tên CK nhận','C','CA3383',100,null,'LIKE,=',null,'Y','N','N',100,null,'ISSNAME','N','61',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (27,'FROMCUSADD','TVLK bên chuyển','C','CA3383',100,null,'LIKE,=',null,'Y','Y','N',100,null,'FROMCUSADD','N','25',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (26,'ISSUERMEMBERCD','Thành viên quản trị TCPH','C','CA3383',50,null,'LIKE,=',null,'Y','N','N',50,null,'Issuer member','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (25,'ISSNAME','Tên chứng khoán ','C','CA3383',100,null,'LIKE,=',null,'Y','Y','N',100,null,'ISSNAME','N','38',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (22,'TRADEPLACE','Nơi đặt','C','CA3383',100,null,'=',null,'Y','Y','N',80,null,'Tradeplace','N','37',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (20,'TRFLIMIT','Chuyển nhượng quyền mua','C','CA3383',1,null,'=',null,'N','N','N',80,null,'Tranfer limit','N','31',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (19,'IDPLACE','Nơi cấp ','C','CA3383',100,null,'LIKE,=',null,'Y','Y','N',100,null,'ID Place','N','94',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (18,'IDDATE','Ngày cấp','D','CA3383',100,'__/__/____','<,<=,=,>=,>,<>','##/##/####','Y','Y','N',100,null,'ID Date','N','93',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (17,'LICENSE','CMND Số','C','CA3383',100,null,'LIKE,=',null,'Y','Y','N',100,null,'ID Code','N','92',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (16,'COUNTRY','Quốc tịch','C','CA3383',200,null,'LIKE,=',null,'Y','Y','N',200,null,'COUNTRY','N','80',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (16,'ADDRESS','Địa chỉ','C','CA3383',200,null,'LIKE,=',null,'Y','Y','N',200,null,'Address','N','91',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (15,'CUSTNAME','Tên khách hàng','C','CA3383',200,null,'LIKE,=',null,'Y','Y','N',200,null,'Full Name','N','90',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (14,'EXPRICE','Giá','N','CA3383',100,null,'<,<=,=,>=,>','#,##0','Y','Y','N',100,null,'EXPRICE','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (9,'QTTY','Số lượng quyền mua','N','CA3383',100,null,'<,<=,=,>=,>','#,##0','Y','Y','N',100,null,'Quantity','N','21',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (9,'PQTTY','Số lượng','N','CA3383',100,null,'<,<=,=,>=,>','#,##0','N','N','N',100,null,'Quantity','N','22',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (6,'CODEID0','Chứng khoán gốc','C','CA3383',100,null,'=',null,'N','N','N',80,null,'Symbol','N','05',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (6,'CODEID','Chứng khoán','C','CA3383',100,null,'=',null,'Y','Y','N',80,null,'Symbol','N','01',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (5,'CATYPE','Loại TH quyền','C','CA3383',100,null,'=',null,'Y','Y','N',100,null,'Coporate type','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (5,'STATUS','Trạng thái','C','CA3383',100,null,'LIKE,=',null,'Y','N','N',80,null,'Status','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (4,'TOSYMBOL','CK nhận','C','CA3383',100,null,'LIKE,=',null,'Y','N','N',80,null,'Symbol','N','60',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (3,'SYMBOL','CK chốt','C','CA3383',100,null,'LIKE,=',null,'Y','Y','N',80,null,'Symbol','N','35',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (2,'CUSTODYCD','Số TK lưu ký','C','CA3383',100,null,'=, LIKE','_','Y','Y','N',100,null,'Custody Code','N','36',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (2,'AFACCTNO','Mã Tiểu khoản','C','CA3383',100,null,'=','_','Y','Y','N',100,null,'Contrac No','N','02',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (2,'ISSUERMEMBER','Thành viên quản trị TCPH','C','CA3383',100,null,'LIKE,=',null,'Y','Y','N',100,null,'Issuer member','N','40',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (1,'CAMASTID','Mã TH quyền','C','CA3383',100,'cccc.cccccc.cccccc','LIKE,=','_','Y','Y','N',120,null,'CA code','N','06',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (0,'AUTOID','Số tự tăng','C','CA3383',100,null,'<,<=,=,>=,>',null,'N','N','N',100,null,'AutoId','N','09',null,'N',null,null,null,'N');
COMMIT;
/
