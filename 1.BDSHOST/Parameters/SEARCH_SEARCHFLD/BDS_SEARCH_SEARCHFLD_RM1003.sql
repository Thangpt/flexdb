--
--
/
DELETE SEARCH WHERE SEARCHCODE = 'RM1003';
INSERT INTO SEARCH (SEARCHCODE,SEARCHTITLE,EN_SEARCHTITLE,SEARCHCMDSQL,OBJNAME,FRMNAME,ORDERBYCMDSQL,TLTXCD,CNTRECORD,ROWPERPAGE,AUTOSEARCH,INTERVAL,AUTHCODE,ROWLIMIT,CMDTYPE)
VALUES ('RM1003','Danh sách KH cần phong toả thu phí lưu ký (6640)','View account must hold for custody fee (6640)','SELECT CF.CUSTODYCD,AF.ACCTNO,CF.FULLNAME,CF.ADDRESS,CF.IDCODE LICENSE,CF.CAREBY,
AF.BANKACCTNO,CRB.BANKCODE,CRB.BANKCODE || CRB.BANKNAME BANKNAME,CI.HOLDBALANCE,
GETAVLPP(AF.ACCTNO) AVLRELEASE,
CASE WHEN CI.HOLDBALANCE-CI.DEPOFEEAMT>0 THEN 0 ELSE CI.DEPOFEEAMT-CI.HOLDBALANCE END MUSTHOLDAMT
FROM CIMAST CI,AFMAST AF,CFMAST CF,CRBDEFBANK CRB
WHERE CI.AFACCTNO=AF.ACCTNO AND AF.CUSTID=CF.CUSTID
AND CI.COREBANK=''Y''
AND AF.BANKNAME=CRB.BANKCODE
AND CASE WHEN CI.HOLDBALANCE-CI.DEPOFEEAMT>0 THEN 0 ELSE CI.DEPOFEEAMT-CI.HOLDBALANCE END >0
AND NOT EXISTS (
    SELECT * FROM CRBTXREQ REQ WHERE REQ.AFACCTNO=AF.ACCTNO AND REQ.TRFCODE IN (''HOLD'')
    AND REQ.TXDATE=(SELECT TO_DATE(SYS.VARVALUE,''DD/MM/RRRR'') FROM SYSVAR SYS WHERE VARNAME=''CURRDATE'')
    AND REQ.TXAMT=(CASE WHEN CI.HOLDBALANCE-CI.DEPOFEEAMT>0 THEN 0 ELSE CI.DEPOFEEAMT-CI.HOLDBALANCE END)
    AND REQ.STATUS IN (''C'',''P'',''E'')
)','CRBTRFLOG',null,null,'6640',0,50,'N',30,null,'Y','T');
COMMIT;
/
--
--
/
DELETE SEARCHFLD WHERE SEARCHCODE = 'RM1003';
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (10,'MUSTHOLDAMT','Số dư cần hold thêm','N','RM1003',150,'###,##0','>=,<=,=',null,'Y','Y','N',150,null,'Must hold','N','10',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (9,'HOLDBALANCE','Số dư phong toả','N','RM1003',120,'###,##0','>=,<=,=',null,'Y','Y','N',100,null,'Hold balance','N','12',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (8,'BANKNAME','Tên NH','C','RM1003',200,null,'LIKE,=',null,'Y','Y','N',200,null,'Bank name','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (7,'BANKCODE','Mã NH','C','RM1003',80,null,'LIKE,=',null,'N','N','N',80,null,'Bank code','N','95',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (6,'BANKACCTNO','TK ngân hàng','C','RM1003',150,null,'LIKE,=',null,'Y','Y','N',150,null,'Bank acctno','N','93',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (5,'CAREBY','Quản lý','C','RM1003',100,null,'LIKE,=',null,'Y','Y','N',80,null,'Careby','N','97',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (4,'LICENSE','CMND','C','RM1003',100,null,'LIKE,=',null,'Y','Y','N',100,null,'License','N','92',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (3,'ADDRESS','Địa chỉ','C','RM1003',200,null,'LIKE,=',null,'N','N','N',250,null,'Address','N','91',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (2,'FULLNAME','Tên KH','C','RM1003',150,null,'LIKE,=',null,'Y','Y','N',150,null,'Customer name','N','90',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (1,'ACCTNO','Tiểu khoản','C','RM1003',80,'ccccgcccccc','LIKE,=',null,'Y','Y','Y',100,null,'Acctno','N','03',null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (0,'CUSTODYCD','TK lưu ký','C','RM1003',80,null,'LIKE,=',null,'Y','Y','N',100,null,'Custody cd','N','88',null,'N',null,null,null,'N');
COMMIT;
/
