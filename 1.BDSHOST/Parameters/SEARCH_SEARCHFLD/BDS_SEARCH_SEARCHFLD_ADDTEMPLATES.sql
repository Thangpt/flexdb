--
--
/
DELETE SEARCH WHERE SEARCHCODE = 'ADDTEMPLATES';
INSERT INTO SEARCH (SEARCHCODE,SEARCHTITLE,EN_SEARCHTITLE,SEARCHCMDSQL,OBJNAME,FRMNAME,ORDERBYCMDSQL,TLTXCD,CNTRECORD,ROWPERPAGE,AUTOSEARCH,INTERVAL,AUTHCODE,ROWLIMIT,CMDTYPE)
VALUES ('ADDTEMPLATES','Thông tin mẫu SMS/Email','SMS/Email templates','SELECT T.CODE, T.NAME, T.SUBJECT, A1.CDCONTENT TYPE, A2.CDCONTENT CYCLE,
       A3.CDCONTENT FORMAT, A4.CDCONTENT REQUIRE_REGISTER, T.EXPORT_PATH, A5.CDCONTENT ALLOW_ZIP
  FROM TEMPLATES T
 INNER JOIN ALLCODE A1 ON T.TYPE = A1.CDVAL AND A1.CDTYPE = ''SY'' AND A1.CDNAME = ''TEMPLATE_TYPE''
 INNER JOIN ALLCODE A2 ON T.CYCLE = A2.CDVAL AND A2.CDTYPE = ''SY'' AND A2.CDNAME = ''TEMPLATE_CYCLE''
 INNER JOIN ALLCODE A3 ON T.FORMAT = A3.CDVAL AND A3.CDTYPE = ''SY'' AND A3.CDNAME = ''TEMPLATE_FORMAT''
 INNER JOIN ALLCODE A4 ON T.REQUIRE_REGISTER = A4.CDVAL AND A4.CDTYPE = ''SY'' AND A4.CDNAME = ''TEMPLATE_REQUIRED''
 INNER JOIN ALLCODE A5 ON CASE WHEN T.TYPE = ''H'' THEN T.ALLOW_ZIP ELSE ''N'' END = A5.CDVAL AND A5.CDTYPE = ''SY''
   AND A5.CDNAME = ''YESNO''
 where code not in (select template_code from aftemplates where afacctno =''<@KEYVALUE>'')
 AND REQUIRE_REGISTER=''Y''','TEMPLATES',null,'NAME','EXEC',null,50,'N',30,null,'Y','T');
COMMIT;
/
--
--
/
DELETE SEARCHFLD WHERE SEARCHCODE = 'ADDTEMPLATES';
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (9,'ALLOW_ZIP','Nén file','C','ADDTEMPLATES',10,'9999.999999','=','_','Y','Y','N',100,null,'Customer ID','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (8,'EXPORT_PATH','Đường dẫn chứa file gửi kèm email','C','ADDTEMPLATES',10,'9999.999999','LIKE,=','_','Y','Y','N',100,null,'Customer ID','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (7,'REQUIRED','Yêu cầu đăng ký','C','ADDTEMPLATES',10,'9999.999999','=','_','Y','Y','N',100,null,'Customer ID','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (6,'FORMAT','Định dạng','C','ADDTEMPLATES',10,'9999.999999','=','_','Y','Y','N',100,null,'Customer ID','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (5,'CYCLE','Chu kỳ gửi','C','ADDTEMPLATES',10,'9999.999999','=','_','Y','Y','N',100,null,'Customer ID','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (4,'TYPE','Loại','C','ADDTEMPLATES',10,'9999.999999','=','_','Y','Y','N',100,null,'Customer ID','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (3,'SUBJECT','Tiêu đề mẫu','C','ADDTEMPLATES',300,null,'LIKE,=',null,'Y','Y','N',300,null,'Full name','Y',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (2,'NAME','Tên file mẫu','C','ADDTEMPLATES',10,'ccccc','LIKE,=','_','Y','N','N',100,null,'Custody code','N',null,null,'N',null,null,null,'N');
INSERT INTO SEARCHFLD (POSITION,FIELDCODE,FIELDNAME,FIELDTYPE,SEARCHCODE,FIELDSIZE,MASK,OPERATOR,FORMAT,DISPLAY,SRCH,KEY,WIDTH,LOOKUPCMDSQL,EN_FIELDNAME,REFVALUE,FLDCD,DEFVALUE,MULTILANG,ACDTYPE,ACDNAME,FIELDCMP,FIELDCMPKEY)
VALUES (1,'CODE','Mã mẫu','C','ADDTEMPLATES',10,'cccc','LIKE,=','_','Y','Y','Y',100,null,'Custody code','N',null,null,'N',null,null,null,'N');
COMMIT;
/
