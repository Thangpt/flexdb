CREATE OR REPLACE FUNCTION fn_getDEFFEEMASTER(PV_CUSTODYCD_FROM IN VARCHAR2,PV_CUSTODYCD_TO IN VARCHAR2)
    RETURN VARCHAR2 IS
    V_RESULT VARCHAR2(10);
    V_CUSTODYCD_FROM VARCHAR2(10);
    V_CUSTODYCD_TO VARCHAR2(10);

BEGIN

IF INSTR(upper(PV_CUSTODYCD_FROM),'C') >0 and INSTR(upper(PV_CUSTODYCD_TO),'C') > 0 then

    SELECT CASE WHEN PV_CUSTODYCD_FROM = PV_CUSTODYCD_TO THEN '00014' ELSE '00015' END INTO V_RESULT FROM DUAL;
else

    SELECT CUSTODYCD INTO V_CUSTODYCD_FROM FROM CFMAST CF, AFMAST AF WHERE CF.CUSTID = AF.CUSTID AND AF.ACCTNO = REPLACE(PV_CUSTODYCD_FROM,'.','');

    SELECT CUSTODYCD INTO V_CUSTODYCD_TO FROM CFMAST CF, AFMAST AF WHERE CF.CUSTID = AF.CUSTID AND AF.ACCTNO = REPLACE(PV_CUSTODYCD_TO,'.','');

    SELECT CASE WHEN V_CUSTODYCD_FROM = V_CUSTODYCD_TO THEN '00014' ELSE '00015' END INTO V_RESULT FROM DUAL;
end if;


RETURN V_RESULT;
EXCEPTION
   WHEN OTHERS THEN
    RETURN '';
END;
/

