CREATE OR REPLACE FUNCTION fn_getTransferMoneyFee(PV_AMOUNT IN number,P_FEETYPE IN VARCHAR2)
    RETURN NUMBER IS
    V_RESULT NUMBER;

BEGIN
V_RESULT :=0;

SELECT  round(LEAST(GREATEST(CASE WHEN FORP='F' THEN FEEAMT ELSE FEERATE * PV_AMOUNT  END, MINVAL),MAXVAL)) INTO V_RESULT
FROM FEEMASTER WHERE FEECD = P_FEETYPE AND STATUS ='Y';

RETURN V_RESULT;
EXCEPTION
   WHEN OTHERS THEN
    RETURN 0;
END;
/

