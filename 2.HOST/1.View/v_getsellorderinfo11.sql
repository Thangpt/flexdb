CREATE OR REPLACE FORCE VIEW V_GETSELLORDERINFO11 AS
(
SELECT SEACCTNO, SUM(SECUREAMT) SECUREAMT, SUM(SECUREMTG) SECUREMTG, SUM(RECEIVING) SERECEIVING
 FROM (
    SELECT OD.SEACCTNO,
           CASE WHEN OD.EXECTYPE IN ('NS', 'SS') THEN REMAINQTTY + EXECQTTY ELSE 0 END SECUREAMT,
           CASE WHEN OD.EXECTYPE = 'MS'  THEN REMAINQTTY + EXECQTTY ELSE 0 END SECUREMTG,
           0 RECEIVING
       FROM ODMAST OD, ODTYPE TYP, SYSVAR SY
       WHERE OD.DELTD <> 'Y' AND OD.STSSTATUS='N' AND OD.EXECTYPE IN ('NS', 'SS','MS')
           And OD.ACTYPE = TYP.ACTYPE
           AND SY.GRNAME = 'SYSTEM' AND SY.VARNAME = 'CURRDATE'
           AND OD.TXDATE =to_date(SY.VARVALUE,'DD/MM/YYYY')
           AND OD.edstatus <> 'W'
    )
GROUP BY SEACCTNO
);

