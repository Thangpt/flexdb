-- Start of DDL Script for View HOSTMSTRADE.V_FO_DEFRULES
-- Generated 31/01/2019 9:25:02 AM from HOSTMSTRADE@FLEX_111

CREATE OR REPLACE VIEW v_fo_defrules (
   reftype,
   refcode,
   rulename,
   refcval,
   refnval )
AS
SELECT REFTYPE, REFCODE, RULENAME, REFCVAL, REFNVAL FROM
(
SELECT  'C' REFTYPE, 'HSX.HSX' REFCODE ,'TRADELOT' RULENAME ,NULL REFCVAL, 100  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'HNX.HNX' REFCODE ,'TRADELOT' RULENAME,NULL REFCVAL, 100  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'HSX.HSX' REFCODE ,'MINNMLQTTY' RULENAME,NULL REFCVAL, 100  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'HNX.UPCOM' REFCODE ,'TRADELOT' RULENAME,NULL REFCVAL, 100  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'HSX.HSX' REFCODE ,'MAXNMLQTTY' RULENAME,NULL REFCVAL, 500000  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'HNX.HNX' REFCODE ,'MAXNMLQTTY' RULENAME,NULL REFCVAL, 999900  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'HNX.UPCOM' REFCODE ,'MAXNMLQTTY' RULENAME,NULL REFCVAL, 999900  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'HNX.HNX' REFCODE ,'MINCROSS' RULENAME,NULL REFCVAL, 5000  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'HNX.UPCOM' REFCODE ,'MINCROSS' RULENAME,NULL REFCVAL, 1  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'HSX.HSX' REFCODE ,'MINCROSS' RULENAME,NULL REFCVAL, 20000  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'VAT' REFCODE ,'VAT' RULENAME,NULL REFCVAL, to_number(sys.varvalue)  REFNVAL FROM sysvar sys
WHERE sys.varname = 'ADVSELLDUTY' and sys.grname = 'SYSTEM'
UNION ALL
SELECT  'C' REFTYPE, 'HSX.HSX' REFCODE ,'MINCROSS_DB' RULENAME,NULL REFCVAL, 1  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'HNX.HNX' REFCODE ,'MINCROSS_DB' RULENAME,NULL REFCVAL, 1000  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'HNX.UPCOM' REFCODE ,'MINCROSS_DB' RULENAME,NULL REFCVAL, 1  REFNVAL FROM dual
UNION ALL
--1.5.6.0
SELECT  'C' REFTYPE, 'HNX.BOND' REFCODE ,'TRADELOT' RULENAME,NULL REFCVAL, 100  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'HNX.BOND' REFCODE ,'MAXNMLQTTY' RULENAME,NULL REFCVAL, 999900  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'HNX.BOND' REFCODE ,'MINCROSS' RULENAME,NULL REFCVAL, 5000  REFNVAL FROM dual
UNION ALL
SELECT  'C' REFTYPE, 'HNX.BOND' REFCODE ,'MINCROSS_DB' RULENAME,NULL REFCVAL, 1000  REFNVAL FROM dual
UNION ALL
--1.5.6.0
SELECT  actiontype REFTYPE, REFCODE , RULENAME, REFCVAL, 0  REFNVAL
FROM t_fo_inday_defrules
UNION ALL
SELECT 'S' REFTYPE,'POOLADV' REFCODE,'ISSTOPADV' ISSTOPADV,VARVALUE REFCVAL,0  REFNVAL FROM sysvar WHERE varname ='ISSTOPADV' AND GRNAME = 'MARGIN'
/*SELECT  'I' REFTYPE, REFID REFCODE , decode(BORS,'B','CANNOTBUY','CANNOTSELL') RULENAME,
s.symbol REFCVAL, 0  REFNVAL
FROM
(SELECT REFID, BORS, codeid, EFFDATE, EXPDATE
             FROM  AFSERULE
             WHERE  BORS IN ('B','S')
            UNION ALL
           SELECT REFID, 'B' BORS, codeid, EFFDATE, EXPDATE
             FROM  AFSERULE
             WHERE  BORS IN ('A')
            UNION ALL
           SELECT REFID, 'S' BORS, codeid, EFFDATE, EXPDATE
             FROM  AFSERULE
             WHERE  BORS IN ('A')) AFSERULE , SECURITIES_INFO s
WHERE EFFDATE <= (SELECT to_date(VARVALUE,'dd/mm/yyyy') FROM sysvar WHERE VARNAME ='CURRDATE' )
AND EXPDATE > (SELECT to_date(VARVALUE,'dd/mm/yyyy') FROM sysvar WHERE VARNAME ='CURRDATE' )
AND AFSERULE.codeid = s.codeid
UNION ALL
SELECT DISTINCT REFTYPE, REFCODE, RULENAME, REFCVAL,REFNVAL
FROM
(
SELECT  'I' REFTYPE, AFACCTNO REFCODE ,
CASE WHEN TLTXCD IN ('8874','8876') THEN 'CANNOTBUY'
     WHEN TLTXCD IN ('8875','8877') THEN 'CANNOTSELL'
END RULENAME ,
'ALL' REFCVAL, 0  REFNVAL FROM AFTXMAP
WHERE EFFDATE <= (SELECT to_date(VARVALUE,'dd/mm/yyyy') FROM sysvar WHERE VARNAME ='CURRDATE' )
AND EXPDATE > (SELECT to_date(VARVALUE,'dd/mm/yyyy') FROM sysvar WHERE VARNAME ='CURRDATE' )
AND  TLTXCD IN ('8874','8876','8875','8877') AND DELTD <> 'Y'
)*/
)
/


-- End of DDL Script for View HOSTMSTRADE.V_FO_DEFRULES

