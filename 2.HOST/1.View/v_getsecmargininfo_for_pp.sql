CREATE OR REPLACE FORCE VIEW V_GETSECMARGININFO_FOR_PP AS
SELECT AF.ACCTNO AFACCTNO,
   nvl(afmr.SEAMT,0) + nvl(od.EXECQTTY_AMT,0) + nvl(od.BUYQTTY_AMT,0) SEAMT,
   nvl(afmr.SEMRAMT,0) + nvl(od.EXECQTTY_MRAMT,0) + nvl(od.BUYQTTY_MRAMT,0) SEMRAMT,
   nvl(afmr.SEASS,0) + nvl(od.EXECQTTY_ASS,0) + nvl(od.BUYQTTY_ASS,0) SEASS,
   nvl(afmr.SEMRASS,0) + nvl(od.EXECQTTY_MRASS,0) + nvl(od.BUYQTTY_MRASS,0) SEMRASS
FROM AFMAST AF, afmargininfo AFMR, V_GETSECMARGININFO_OD OD
WHERE AF.ACCTNO=OD.AFACCTNO (+) and AF.ACCTNO = AFMR.AFACCTNO(+)
ORDER BY AF.ACCTNO;

